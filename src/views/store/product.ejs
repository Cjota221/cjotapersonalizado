<!DOCTYPEhtml>
<htmllang="pt-BR">
<head>
<metacharset="UTF-8">
<metaname="viewport"content="width=device-width,initial-scale=1.0">
<title><%=product.name%>-<%=store.store_name%></title>
<linkrel="stylesheet"href="/css/store.css">
<style><%=storeCSS%></style>
</head>
<body>
<headerclass="store-header">
<divclass="container">
<%if(store.logo_url){%>
<imgsrc="<%=store.logo_url%>"alt="<%=store.store_name%>"class="store-logo">
<%}%>
<h1><%=store.store_name%></h1>
<nav>
<ahref="/<%=store.slug%>">&larr;Voltar</a>
</nav>
</div>
</header>

<mainclass="container">
<divclass="product-detail">
<divclass="product-gallery">
<%if(product.images&&product.images.length>0){%>
<imgsrc="<%=product.images[0]%>"alt="<%=product.name%>"class="main-image"id="main-image">
<%if(product.images.length>1){%>
<divclass="thumbnails">
<%product.images.forEach((img,idx)=>{%>
<imgsrc="<%=img%>"alt="<%=product.name%>"class="thumbnail"onclick="changeImage('<%=img%>')">
<%})%>
</div>
<%}%>
<%}else{%>
<imgsrc="/images/placeholder.jpg"alt="<%=product.name%>"class="main-image">
<%}%>
</div>

<divclass="product-info-detail">
<h2><%=product.name%></h2>
<pclass="product-description"><%=product.description%></p>

<divclass="variants-section">
<h3>Selecionetamanhoequantidade:</h3>

<%if(variants.length===0){%>
<pclass="alertalert-warning">Produtosemvariaçõesdisponíveisnomomento.</p>
<%}else{%>
<tableclass="variants-table">
<thead>
<tr>
<th>Tamanho</th>
<th>Cor</th>
<th>Preço</th>
<th>Estoque</th>
<th>Quantidade</th>
</tr>
</thead>
<tbody>
<%variants.forEach(variant=>{%>
<tr>
<td><%=variant.size%></td>
<td><%=variant.color||'-'%></td>
<td><%=formatPrice(variant.price_cents)%></td>
<td><%=variant.stock%>un.</td>
<td>
<input
type="number"
min="0"
max="<%=variant.stock%>"
value="0"
class="qty-input"
data-variant-id="<%=variant.id%>"
data-variant-size="<%=variant.size%>"
data-variant-color="<%=variant.color||''%>"
data-product-name="<%=product.name%>"
data-price="<%=variant.price_cents%>"
>
</td>
</tr>
<%})%>
</tbody>
</table>
<%}%>
</div>

<buttonclass="btnbtn-primarybtn-large"onclick="addToCart()">
AdicionaraoCarrinho
</button>

<divclass="alertalert-info"style="margin-top:1rem;">
<strong>💡Importante:</strong>Estesitenãoprocessapagamento.VocêestámontandoumpedidoqueseráfinalizadoviaWhatsAppcomafábrica.
</div>
</div>
</div>
</main>

<footer>
<p>&copy;2026<%=store.store_name%>-PoweredbyCJota</p>
</footer>

<script>
functionchangeImage(src){
document.getElementById('main-image').src=src;
}

functionaddToCart(){
constinputs=document.querySelectorAll('.qty-input');
constcart=JSON.parse(localStorage.getItem('cart')||'[]');
letaddedCount=0;

inputs.forEach(input=>{
constqty=parseInt(input.value)||0;
if(qty>0){
cart.push({
product_id:<%=product.id%>,
variant_id:input.dataset.variantId,
product_name:input.dataset.productName,
variant_size:input.dataset.variantSize,
variant_color:input.dataset.variantColor,
qty:qty,
price_cents:parseInt(input.dataset.price)
});
addedCount+=qty;
input.value=0;
}
});

if(addedCount>0){
localStorage.setItem('cart',JSON.stringify(cart));
alert(`${addedCount}item(ns)adicionado(s)aocarrinho!`);
window.location.href='/<%=store.slug%>/cart';
}else{
alert('Selecioneaomenosumaquantidadeparaadicionaraocarrinho.');
}
}
</script>
</body>
</html>
