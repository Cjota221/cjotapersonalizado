<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Personalização do Site - Dashboard</title>
  <link rel="stylesheet" href="/css/nuvemshop-admin.css">
  <style>
    .color-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 24px;
      margin-top: 24px;
    }
    
    .color-picker-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .color-picker-group label {
      font-size: 14px;
      font-weight: 600;
      color: #1a1d1f;
    }
    
    .color-input-wrapper {
      display: flex;
      gap: 12px;
      align-items: center;
    }
    
    .color-input-wrapper input[type="color"] {
      width: 60px;
      height: 40px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      cursor: pointer;
    }
    
    .color-input-wrapper .color-text {
      flex: 1;
      padding: 8px 12px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      background: #f8f9fa;
    }
    
    .color-picker-group small {
      color: #6f767e;
      font-size: 12px;
    }
    
    .file-upload-zone {
      margin-top: 16px;
      border: 2px dashed #d1d5db;
      border-radius: 8px;
      padding: 32px;
      text-align: center;
      background: #f8f9fa;
      transition: all 0.2s;
    }
    
    .file-upload-zone:hover {
      border-color: #0066ff;
      background: #f0f7ff;
    }
    
    .file-input {
      display: none;
    }
    
    .file-label {
      cursor: pointer;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }
    
    .upload-icon {
      font-size: 32px;
      color: #6f767e;
    }
    
    .file-label span {
      font-size: 14px;
      font-weight: 500;
      color: #1a1d1f;
    }
    
    .file-label small {
      font-size: 12px;
      color: #6f767e;
    }
    
    .logo-preview {
      margin-bottom: 16px;
      padding: 16px;
      background: #f8f9fa;
      border-radius: 8px;
      display: inline-block;
    }
    
    .logo-preview img {
      max-width: 200px;
      max-height: 80px;
      display: block;
    }
    
    .section-description {
      color: #6f767e;
      font-size: 14px;
      margin-top: 8px;
      line-height: 1.5;
    }
    
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-top: 24px;
    }
    
    @media (max-width: 768px) {
      .color-grid,
      .form-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="admin-container">
    <!-- Sidebar -->
    <aside class="admin-sidebar">
      <div class="sidebar-header">
        <a href="/dashboard" class="sidebar-logo">CJota Admin</a>
      </div>
      
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Principal</div>
          <a href="/dashboard" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="7" height="7"></rect>
              <rect x="14" y="3" width="7" height="7"></rect>
              <rect x="14" y="14" width="7" height="7"></rect>
              <rect x="3" y="14" width="7" height="7"></rect>
            </svg>
            Dashboard
          </a>
          <a href="/dashboard/produtos" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 3h18v18H3z"></path>
              <path d="M3 9h18"></path>
              <path d="M9 21V9"></path>
            </svg>
            Produtos
          </a>
          <a href="/dashboard/orders" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 2L3 8v13h18V8l-6-6H9z"></path>
              <polyline points="9 8 9 2 15 2 15 8"></polyline>
            </svg>
            Pedidos
          </a>
        </div>
        
        <div class="nav-section">
          <div class="nav-section-title">Configurações</div>
          <a href="/dashboard/store-settings" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 2v4m0 12v4m8-10h-4m-12 0H0m15.364 6.364l-2.828-2.828m-8.486 0L1.222 18.364M18.364 5.636l-2.828 2.828m-8.486 0L4.222 5.636"></path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
            Loja
          </a>
          <a href="/dashboard/branding" class="nav-item active">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="2" y="3" width="20" height="14" rx="2"></rect>
              <line x1="8" y1="21" x2="16" y2="21"></line>
              <line x1="12" y1="17" x2="12" y2="21"></line>
            </svg>
            Personalização
          </a>
        </div>
      </nav>
    </aside>
    
    <!-- Main Content -->
    <main class="admin-main">
      <header class="admin-header">
        <h1 class="page-title">Personalização do Site</h1>
        <div class="header-actions">
          <a href="/" target="_blank" class="btn btn-secondary btn-sm">Ver Site</a>
        </div>
      </header>
      
      <div class="admin-content">
        
        <% if (typeof success !== 'undefined' && success) { %>
          <div style="padding: 16px; border-radius: 8px; background: #e6f9f3; color: #00c48c; border: 1px solid #00c48c; margin-bottom: 24px;">
            <%= success %>
          </div>
        <% } %>
        
        <% if (typeof error !== 'undefined' && error) { %>
          <div style="padding: 16px; border-radius: 8px; background: #ffe6e6; color: #ff4757; border: 1px solid #ff4757; margin-bottom: 24px;">
            <%= error %>
          </div>
        <% } %>
        
        <form action="/dashboard/branding" method="POST" enctype="multipart/form-data">
          
          <!-- Informações Gerais -->
          <div class="card" style="margin-bottom: 24px;">
            <div class="card-header">
              <h2 class="card-title">Informações Gerais</h2>
            </div>
            <div class="card-body">
              <div class="form-grid">
                <div class="form-group">
                  <label for="site_name" class="form-label">Nome do Site</label>
                  <input 
                    type="text" 
                    id="site_name" 
                    name="site_name" 
                    class="form-input"
                    value="<%= siteSettings?.site_name || 'CJota Catálogo' %>"
                  >
                </div>
                
                <div class="form-group">
                  <label for="site_description" class="form-label">Descrição</label>
                  <input 
                    type="text" 
                    id="site_description" 
                    name="site_description" 
                    class="form-input"
                    value="<%= siteSettings?.site_description || '' %>"
                  >
                </div>
                
                <div class="form-group">
                  <label for="whatsapp_number" class="form-label">WhatsApp (com DDI)</label>
                  <input 
                    type="text" 
                    id="whatsapp_number" 
                    name="whatsapp_number" 
                    class="form-input"
                    placeholder="5511999999999"
                    value="<%= siteSettings?.whatsapp_number || '' %>"
                  >
                  <div class="form-help">Exemplo: 5511999999999</div>
                </div>
                
                <div class="form-group">
                  <label for="email" class="form-label">E-mail de Contato</label>
                  <input 
                    type="email" 
                    id="email" 
                    name="email" 
                    class="form-input"
                    value="<%= siteSettings?.email || '' %>"
                  >
                </div>
              </div>
            </div>
          </div>
          
          <!-- Logo -->
          <div class="card" style="margin-bottom: 24px;">
            <div class="card-header">
              <h2 class="card-title">Logo do Site</h2>
            </div>
            <div class="card-body">
              <% if (siteSettings?.logo_url) { %>
                <div class="logo-preview">
                  <img src="<%= siteSettings.logo_url %>" alt="Logo atual">
                </div>
              <% } %>
              
              <div class="file-upload-zone">
                <input 
                  type="file" 
                  id="logo" 
                  name="logo" 
                  accept="image/*"
                  class="file-input"
                >
                <label for="logo" class="file-label">
                  <span class="upload-icon">↑</span>
                  <span>Clique para selecionar ou arraste a logo</span>
                  <small>PNG, JPG ou SVG (máx 2MB, recomendado 200x60px)</small>
                </label>
              </div>
            </div>
          </div>
          
          <!-- Paleta de Cores -->
          <div class="card" style="margin-bottom: 24px;">
            <div class="card-header">
              <h2 class="card-title">Paleta de Cores</h2>
            </div>
            <div class="card-body">
              <p class="section-description">
                Personalize as cores do seu catálogo. As mudanças serão aplicadas em todo o site.
              </p>
              
              <div class="color-grid">
                <div class="color-picker-group">
                  <label for="color_primary">Cor Primária</label>
                  <div class="color-input-wrapper">
                    <input 
                      type="color" 
                      id="color_primary" 
                      name="color_primary" 
                      value="<%= siteSettings?.color_primary || '#1a1a1a' %>"
                    >
                    <input 
                      type="text" 
                      class="color-text" 
                      value="<%= siteSettings?.color_primary || '#1a1a1a' %>"
                      readonly
                    >
                  </div>
                  <small>Textos e elementos principais</small>
                </div>
                
                <div class="color-picker-group">
                  <label for="color_secondary">Cor Secundária</label>
                  <div class="color-input-wrapper">
                    <input 
                      type="color" 
                      id="color_secondary" 
                      name="color_secondary" 
                      value="<%= siteSettings?.color_secondary || '#4a5568' %>"
                    >
                    <input 
                      type="text" 
                      class="color-text" 
                      value="<%= siteSettings?.color_secondary || '#4a5568' %>"
                      readonly
                    >
                  </div>
                  <small>Elementos secundários</small>
                </div>
                
                <div class="color-picker-group">
                  <label for="color_accent">Cor de Destaque</label>
                  <div class="color-input-wrapper">
                    <input 
                      type="color" 
                      id="color_accent" 
                      name="color_accent" 
                      value="<%= siteSettings?.color_accent || '#3b82f6' %>"
                    >
                    <input 
                      type="text" 
                      class="color-text" 
                      value="<%= siteSettings?.color_accent || '#3b82f6' %>"
                      readonly
                    >
                  </div>
                  <small>Botões e CTAs</small>
                </div>
                
                <div class="color-picker-group">
                  <label for="color_success">Cor de Sucesso</label>
                  <div class="color-input-wrapper">
                    <input 
                      type="color" 
                      id="color_success" 
                      name="color_success" 
                      value="<%= siteSettings?.color_success || '#10b981' %>"
                    >
                    <input 
                      type="text" 
                      class="color-text" 
                      value="<%= siteSettings?.color_success || '#10b981' %>"
                      readonly
                    >
                  </div>
                  <small>Mensagens de sucesso</small>
                </div>
                
                <div class="color-picker-group">
                  <label for="color_warning">Cor de Aviso</label>
                  <div class="color-input-wrapper">
                    <input 
                      type="color" 
                      id="color_warning" 
                      name="color_warning" 
                      value="<%= siteSettings?.color_warning || '#f59e0b' %>"
                    >
                    <input 
                      type="text" 
                      class="color-text" 
                      value="<%= siteSettings?.color_warning || '#f59e0b' %>"
                      readonly
                    >
                  </div>
                  <small>Avisos e alertas</small>
                </div>
                
                <div class="color-picker-group">
                  <label for="color_error">Cor de Erro</label>
                  <div class="color-input-wrapper">
                    <input 
                      type="color" 
                      id="color_error" 
                      name="color_error" 
                      value="<%= siteSettings?.color_error || '#ef4444' %>"
                    >
                    <input 
                      type="text" 
                      class="color-text" 
                      value="<%= siteSettings?.color_error || '#ef4444' %>"
                      readonly
                    >
                  </div>
                  <small>Mensagens de erro</small>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Botões de Ação -->
          <div style="display: flex; gap: 12px; justify-content: flex-end;">
            <a href="/dashboard" class="btn btn-secondary">Cancelar</a>
            <button type="submit" class="btn btn-primary">Salvar Alterações</button>
          </div>
        </form>
        
        <!-- Seção de Banners -->
        <% if (typeof activeBanners !== 'undefined' && activeBanners.length > 0) { %>
          <div class="card" style="margin-top: 48px;">
            <div class="card-header">
              <h2 class="card-title">Banners Ativos</h2>
            </div>
            <div class="card-body">
              <div style="display: grid; gap: 16px;">
                <% activeBanners.forEach(banner => { %>
                  <div style="display: flex; gap: 16px; align-items: center; padding: 16px; background: #f8f9fa; border-radius: 8px;">
                    <% if (banner.image_url) { %>
                      <img src="<%= banner.image_url %>" alt="<%= banner.title %>" style="width: 120px; height: 60px; object-fit: cover; border-radius: 4px;">
                    <% } %>
                    <div style="flex: 1;">
                      <h4 style="font-size: 14px; font-weight: 600; margin-bottom: 4px;"><%= banner.title %></h4>
                      <p style="font-size: 13px; color: #6f767e; margin: 0;"><%= banner.subtitle %></p>
                    </div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>
      </div>
    </main>
  </div>
  
  <script>
    // Sincronizar color pickers com inputs de texto
    document.querySelectorAll('input[type="color"]').forEach(colorInput => {
      const textInput = colorInput.nextElementSibling;
      
      colorInput.addEventListener('input', (e) => {
        textInput.value = e.target.value.toUpperCase();
      });
    });
  </script>
</body>
</html>
